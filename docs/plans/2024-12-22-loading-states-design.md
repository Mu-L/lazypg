# Loading States è®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

ä¸º Tree ç»„ä»¶å’Œ Table Data ç»„ä»¶æ·»åŠ åŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

## åœºæ™¯ä¸æ ·å¼

| åœºæ™¯ | æ ·å¼ | ä½ç½® | å¯å–æ¶ˆ | æ–‡æ¡ˆ |
|------|------|------|--------|------|
| Tree åˆå§‹è¿æ¥ | å®Œæ•´ spinner | å±…ä¸­ | âœ— | "Loading databases..." |
| Tree å±•å¼€èŠ‚ç‚¹ | å†…è” spinner | èŠ‚ç‚¹æ—è¾¹ | âœ— | "Loading..." |
| Table é¦–æ¬¡åŠ è½½ | å®Œæ•´ spinner | å±…ä¸­ | âœ“ (Esc) | "Loading table data..." |
| Table ç¿»é¡µåŠ è½½ | ç®€åŒ– spinner | çŠ¶æ€æ  | âœ— | "Loading..." |

## è§†è§‰è®¾è®¡

### Tree åˆå§‹è¿æ¥

```
â”Œâ”€ Explorer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                â”‚
â”‚     â£¾ Loading databases...    â”‚
â”‚           (1.2s)               â”‚
â”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tree å±•å¼€èŠ‚ç‚¹

```
â”Œâ”€ Explorer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¼ ğŸ“ postgres                  â”‚
â”‚   â–¼ ğŸ“ public                  â”‚
â”‚       â£¾ Loading...            â”‚
â”‚   â–¶ ğŸ“ information_schema      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Table é¦–æ¬¡åŠ è½½

```
â”Œâ”€ Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                â”‚
â”‚   â£¾ Loading table data...     â”‚
â”‚           (1.2s)               â”‚
â”‚                                â”‚
â”‚      Press Esc to cancel       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Table ç¿»é¡µåŠ è½½

```
â”Œâ”€ Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  id  â”‚  name   â”‚  created_at  â”‚
â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  1   â”‚  foo    â”‚  2024-01-01  â”‚
â”‚  2   â”‚  bar    â”‚  2024-01-02  â”‚
â”‚  ... â”‚  ...    â”‚  ...         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â£¾ Loading...  â”‚ 1-50 of 1000 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä»£ç æ”¹åŠ¨

### éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | æ”¹åŠ¨å†…å®¹ |
|------|----------|
| `internal/ui/components/tree_view.go` | æ–°å¢åŠ è½½çŠ¶æ€å­—æ®µï¼Œä¿®æ”¹ `View()` æ–¹æ³• |
| `internal/ui/components/table_view.go` | æ–°å¢åŠ è½½çŠ¶æ€å­—æ®µï¼Œä¿®æ”¹ `View()` å’Œ `renderStatus()` |
| `internal/app/app.go` | ä¼ é€’ spinner å®ä¾‹ï¼Œå¤„ç†åŠ è½½çŠ¶æ€åˆ‡æ¢ |

### Tree ç»„ä»¶æ–°å¢å­—æ®µ

```go
type TreeView struct {
    // ... ç°æœ‰å­—æ®µ
    isLoading      bool           // åˆå§‹è¿æ¥åŠ è½½ä¸­
    loadingNodeID  string         // å±•å¼€èŠ‚ç‚¹åŠ è½½ä¸­ï¼ˆèŠ‚ç‚¹ IDï¼‰
    spinner        *spinner.Model // å…±äº« spinner å®ä¾‹
    loadingStart   time.Time      // ç”¨äºè®¡ç®—å·²ç”¨æ—¶é—´
}
```

### Table ç»„ä»¶æ–°å¢å­—æ®µ

```go
type TableView struct {
    // ... ç°æœ‰å­—æ®µ
    isLoading    bool           // é¦–æ¬¡åŠ è½½ä¸­
    isPaginating bool           // ç¿»é¡µåŠ è½½ä¸­
    spinner      *spinner.Model // å…±äº« spinner å®ä¾‹
    loadingStart time.Time      // ç”¨äºè®¡ç®—å·²ç”¨æ—¶é—´
}
```

## å®ç°è¦ç‚¹

1. **å¤ç”¨ç°æœ‰ spinner** - ä½¿ç”¨ `app.go` ä¸­å·²æœ‰çš„ `spinner.Model`
2. **éµå¾ª lipgloss å®½åº¦è®¡ç®—è§„èŒƒ** - ä½¿ç”¨ `GetHorizontalFrameSize()` è®¡ç®—å†…å®¹å®½åº¦
3. **æ ·å¼ç¼“å­˜** - åŠ è½½çŠ¶æ€æ ·å¼ä¹Ÿéœ€è¦ç¼“å­˜ä»¥ä¿è¯æ€§èƒ½
4. **å–æ¶ˆè¡Œä¸º** - Table é¦–æ¬¡åŠ è½½å–æ¶ˆåï¼Œè¡Œä¸ºä¸ query æ‰§è¡Œå–æ¶ˆä¸€è‡´
